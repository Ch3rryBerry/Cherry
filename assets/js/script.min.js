document.addEventListener("DOMContentLoaded", function () {
    const projects = [
        {
            title: "Howest CTF Project Week I",
            description: [
                "During the Cybersecurity Project Week at Howest, I took part in a Capture The Flag (CTF) competition — an intense, hands-on challenge that tested both technical skills and teamwork under pressure...",
                "The CTF featured challenges in cryptography, steganography, reverse engineering, forensics, web exploitation, trivia, programming, and more...",
                "Our team collaborated closely, dividing tasks based on individual strengths...",
                "By the end of the week, we earned 4th place on the official scoreboard — a result we're proud of."
            ],
            images: [
                "./assets/media/HowestCTF1/ctfd-leaderboard.png",
                "./assets/media/HowestCTF1/ctfd-team.png",
                "./assets/media/HowestCTF1/ctfd-profile.png"
            ],
            socials: [
                {
                    platform: "CTFd",
                    link: "https://ctf.cyber3lab.be",
                    icon: "./assets/media/HowestCTF1/ico.ico",
                    tooltip: "Visit the CTF platform"
                }
            ],
        },
        {
            title: "Howest CTF Project Week II",
            description: [
                "This week marked our second Capture The Flag (CTF) Project Week at Howest — this time it was also graded, which added extra pressure to the already intense experience.",
                "The week was filled with challenging tasks that caused more than a few headaches, but it was a great opportunity to push our limits and grow as a team.",
                "Our hard work paid off: we secured 1st place on the official scoreboard, a result I’m incredibly proud of.",
                "We were awarded a trophy for the victory, and I personally won a special challenge by solving it the fastest — earning a unique raisin statue as a prize."
            ],
            images: [
                "./assets/media/HowestCTF2/ctfd2-leaderboard.png",
                "./assets/media/HowestCTF2/ctfd2-team.png",
                "./assets/media/HowestCTF2/ctfd2-profile.png",
                "./assets/media/HowestCTF2/ctfd2-bountyhunt.png",
                "./assets/media/HowestCTF2/ctfd2-trophy.jpg",
                "./assets/media/HowestCTF2/ctfd2-raisin.jpg",
                "./assets/media/HowestCTF2/ctfd2-trophy-raisin.jpg"
            ],
            socials: [
                {
                    platform: "CTFd2",
                    link: "http://scoreboard.ctf.edu.technet.howest.be/",
                    icon: "./assets/media/HowestCTF2/ico.ico",
                    tooltip: "Visit the CTF2 platform"
                }
            ],
        }
    ];

    const blogs = [
        {
            title: "Tech&Meet: Insights from Belgium's Top Ethical Hacker",
            description: [
                "On December 17, 2024, I had the opportunity to attend a Tech&Meet talk at Howest University, where Robbe Verwilghen—an accomplished ethical hacker—shared his story...",
                "The talk centered around Robbe’s participation in Belgium’s government cybersecurity initiative, 'Hack The Government'...",
                "He also reflected on his broader career in cybersecurity...",
                "Even with restrictions on what he could publicly reveal, Robbe delivered an inspiring and practical talk...",
                "In the end, this Tech&Meet experience was not just informative—it was motivating."
            ],
            images: [
                "./assets/media/HackTheHolidays/HackTheHolidays_1.png",
                "./assets/media/HackTheHolidays/HackTheHolidays_2.png",
                "./assets/media/HackTheHolidays/HackTheHolidays_3.jpg"
            ],
        },
        {
            title: "Belgian Defense Launches Cyber Defense Factory at Howest Bruges",
            description: [
                "On Tuesday the 13th of May, I attended the official inauguration of the first Cyber Defense Factory in Flanders, hosted on the very same Howest campus in Bruges...",
                "This groundbreaking initiative marks a long-term collaboration between the military, Howest, and local tech companies to protect naval ships, drones, and critical infrastructure from cyberattacks...",
                "General-Major Michel Van Strythem explained that Bruges would serve as the base for maritime cybersecurity efforts, with new navy vessels—including drone-equipped minehunters—soon arriving in Ostend...",
                "Students, including myself, will have the chance to gain hands-on experience through real-world defense-related cybersecurity cases, such as securing offshore energy platforms and naval systems...",
                "The factory also focuses on talent development, offering internships, summer jobs, and cybersecurity challenges that can lead to careers within the Defense cyber division..."
            ],
            images: [
                "./assets/media/InaugurationCDF/CyberDefenseFactory.mp4",
                "./assets/media/InaugurationCDF/CyberDefenseFactory1.jpg",
                "./assets/media/InaugurationCDF/CyberDefenseFactory2.jpg",
                "./assets/media/InaugurationCDF/CyberDefenseFactory3.jpg"
            ],
            socials: [
                {
                    platform: "VRT",
                    link: "https://www.vrt.be/vrtnws/nl/2025/05/13/defensie-opent-bedrijf-voor-cyberveiligheid-op-campus-van-howest/",
                    icon: "./assets/media/InaugurationCDF/ico4.ico",
                    tooltip: "VRT NEWS"
                }
            ],
        }
    ];

    function generateList(items, containerId, type) {
        const container = document.getElementById(containerId);
        if (!container) return;

        container.innerHTML = "";

        if (items.length === 0) {
            const emptyMessage = document.createElement("p");
            emptyMessage.classList.add("empty-message");
            emptyMessage.innerText = type === "project" ? "No projects available yet." : "No blog posts available yet.";
            container.appendChild(emptyMessage);
            return;
        }

        items.forEach(item => {
            const div = document.createElement("div");
            div.classList.add(type === "project" ? "project-item" : "blog-item");
            div.innerHTML = `<h3>${item.title}</h3><p>${item.description[0]}</p>`;
            div.addEventListener("click", () => openOverlay(item));
            container.appendChild(div);
        });
    }

    function openOverlay(item) {
        const overlay = document.getElementById("overlay");
        const overlayContent = document.querySelector(".overlay-content");

        document.getElementById("overlay-title").innerText = item.title;

        const textContainer = document.getElementById("overlay-text");
        textContainer.innerHTML = "";
        item.description.forEach(para => {
            const p = document.createElement("p");
            p.innerText = para;
            textContainer.appendChild(p);
        });

        const badgeContainer = document.getElementById("overlay-badges");
        badgeContainer.innerHTML = "";
        if (item.badges && item.badges.length > 0) {
            item.badges.forEach(badge => {
                const span = document.createElement("span");
                span.classList.add("badge");
                span.innerText = badge;
                badgeContainer.appendChild(span);
            });
        }

        const socialsContainer = document.getElementById("overlay-socials");
        socialsContainer.innerHTML = "";
        if (item.socials && item.socials.length > 0) {
            item.socials.forEach(social => {
                const a = document.createElement("a");
                a.href = social.link;
                a.target = "_blank";
                a.rel = "noopener noreferrer";
                a.classList.add("social-icon-container");

                const img = document.createElement("img");
                img.src = social.icon;
                img.alt = `${social.platform} icon`;
                img.classList.add("social-icon");

                a.appendChild(img);

                if (social.tooltip) {
                    const tooltip = document.createElement("span");
                    tooltip.classList.add("tooltip");
                    tooltip.innerText = social.tooltip;
                    a.appendChild(tooltip);
                }

                socialsContainer.appendChild(a);
            });
        }

        const galleryContainer = document.getElementById("overlay-gallery");
        galleryContainer.innerHTML = "";
        if (item.images && item.images.length > 0) {
            item.images.forEach(mediaSrc => {
                const isVideo = mediaSrc.endsWith(".mp4");
                const element = isVideo ? document.createElement("video") : document.createElement("img");
                element.src = mediaSrc;
                if (isVideo) {
                    element.muted = true;
                    element.playsInline = true;
                    element.loop = true;
                    element.autoplay = true;
                    element.classList.add("gallery-video");
                } else {
                    element.alt = `${item.title} image`;
                    element.classList.add("gallery-img");
                }
                element.addEventListener("click", () => openMediaFullScreen(mediaSrc, item.images, true));
                galleryContainer.appendChild(element);
            });
        }

        overlay.style.display = "flex";

        overlay.addEventListener("click", (event) => {
            if (!overlayContent.contains(event.target)) {
                closeOverlay();
            }
        });
    }

    function closeOverlay() {
        document.getElementById("overlay").style.display = "none";
    }

    function openMediaFullScreen(src, allMedia, animate = false) {
        let currentIndex = allMedia.indexOf(src);

        const overlayMedia = document.createElement("div");
        overlayMedia.classList.add("fullscreen-overlay");
        document.body.appendChild(overlayMedia);

        function renderMedia(index, useAnimation) {
            const mediaSrc = allMedia[index];
            const isVideo = mediaSrc.endsWith(".mp4");
            const animStyle = useAnimation ? "" : "animation: none; transform: none;";
            const mediaElement = isVideo
                ? `<video src="${mediaSrc}" controls autoplay class="fullscreen-img" style="${animStyle}"></video>`
                : `<img src="${mediaSrc}" class="fullscreen-img" id="fullscreen-active-img" alt="" style="${animStyle}">`;

            overlayMedia.innerHTML = `
                <span class="close-img-btn" onclick="this.parentElement.remove()">&times;</span>
                ${mediaElement}
                <button class="nav-arrow left-arrow">&#10094;</button>
                <button class="nav-arrow right-arrow">&#10095;</button>
            `;

            overlayMedia.querySelector(".left-arrow").addEventListener("click", (e) => {
                e.stopPropagation();
                currentIndex = (currentIndex - 1 + allMedia.length) % allMedia.length;
                renderMedia(currentIndex, false);
            });

            overlayMedia.querySelector(".right-arrow").addEventListener("click", (e) => {
                e.stopPropagation();
                currentIndex = (currentIndex + 1) % allMedia.length;
                renderMedia(currentIndex, false);
            });

            overlayMedia.querySelector(".close-img-btn").addEventListener("click", () => {
                overlayMedia.remove();
            });
        }

        renderMedia(currentIndex, animate);
    }

    document.querySelector(".close-btn").addEventListener("click", closeOverlay);

    generateList(projects, "project-list", "project");
    generateList(blogs, "blog-list", "blog");
});
